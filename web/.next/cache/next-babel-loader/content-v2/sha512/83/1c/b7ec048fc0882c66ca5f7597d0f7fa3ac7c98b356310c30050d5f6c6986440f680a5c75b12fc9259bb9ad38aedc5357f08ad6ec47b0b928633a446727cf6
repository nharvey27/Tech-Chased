{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/nicholasharvey/Desktop/programming/techChased/web/src/pages/tickets/[id].tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { Box, Button, Flex, Grid, GridItem, Heading, IconButton, Link, List, ListItem, Stack, Text } from \"@chakra-ui/react\";\nimport React from \"react\";\nimport { Layout } from \"../../components/Layout\";\nimport { useGetTicketFromUrl } from \"../../utils/useGetTicketFromUrl\";\nimport { withApollo } from \"../../utils/withApollo\";\nimport NextLink from \"next/link\";\nimport { useCreateCommentMutation, useDeleteTicketMutation } from \"../../generated/graphql\";\nimport { DeleteIcon } from \"@chakra-ui/icons\";\nimport { useRouter } from \"next/router\";\nimport { Form, Formik } from \"formik\";\nimport { InputField } from \"../../components/inputField\";\n\nconst Ticket = ({}) => {\n  var _data$ticket, _data$ticket$comments;\n\n  const {\n    data,\n    error,\n    loading\n  } = useGetTicketFromUrl();\n  const [deleteTicket] = useDeleteTicketMutation();\n  const [createComment] = useCreateCommentMutation();\n  const router = useRouter();\n  console.log(data === null || data === void 0 ? void 0 : data.ticket.comments);\n\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(Layout, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"loading..\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 39,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 7\n    }, this);\n  }\n\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: error.message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 12\n    }, this);\n  }\n\n  if (!(data !== null && data !== void 0 && data.ticket)) {\n    return /*#__PURE__*/_jsxDEV(Layout, {\n      children: /*#__PURE__*/_jsxDEV(Box, {\n        children: \" Could not find ticket.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 7\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(Layout, {\n    children: [data.ticket.comments[0].text, /*#__PURE__*/_jsxDEV(Stack, {\n      ml: 4,\n      mb: 10,\n      mt: -2,\n      bg: \"yellow.400\",\n      children: [/*#__PURE__*/_jsxDEV(Heading, {\n        as: \"h3\",\n        ml: 4,\n        size: \"lg\",\n        mb: 3,\n        mt: 3,\n        children: [\"Details for Ticket #\", data.ticket.id]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Flex, {\n        alignItems: \"center\",\n        children: [/*#__PURE__*/_jsxDEV(NextLink, {\n          href: `/tickets/edit/${data.ticket.id}`,\n          children: /*#__PURE__*/_jsxDEV(Link, {\n            ml: 4,\n            children: \"Edit |\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 63,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n          icon: /*#__PURE__*/_jsxDEV(DeleteIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 66,\n            columnNumber: 19\n          }, this),\n          \"aria-label\": \"Delete Ticket\",\n          onClick: () => {\n            deleteTicket({\n              variables: {\n                id: data.ticket.id\n              },\n              update: cache => {\n                cache.evict({\n                  id: \"Ticket:\" + data.ticket.id\n                });\n                router.back();\n              }\n            });\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n      gridTemplateColumns: \"repeat(2, 50%)\",\n      children: [/*#__PURE__*/_jsxDEV(Box, {\n        ml: 4,\n        children: /*#__PURE__*/_jsxDEV(Grid, {\n          templateColumns: \"repeat(2,1fr)\",\n          templateRows: \"auto\",\n          children: [/*#__PURE__*/_jsxDEV(GridItem, {\n            children: /*#__PURE__*/_jsxDEV(Box, {\n              mb: 4,\n              children: [/*#__PURE__*/_jsxDEV(Heading, {\n                mb: 2,\n                as: \"h5\",\n                size: \"sm\",\n                children: \"Ticket Title\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 85,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Text, {\n                ml: 4,\n                size: \"xs\",\n                children: data.ticket.title\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 88,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 84,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(GridItem, {\n            children: /*#__PURE__*/_jsxDEV(Box, {\n              mb: 4,\n              children: [/*#__PURE__*/_jsxDEV(Heading, {\n                mb: 2,\n                as: \"h5\",\n                size: \"sm\",\n                children: \"Ticket Description\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 95,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Text, {\n                ml: 4,\n                size: \"xs\",\n                children: data.ticket.description\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 98,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 94,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(GridItem, {\n            children: /*#__PURE__*/_jsxDEV(Box, {\n              mb: 4,\n              children: [/*#__PURE__*/_jsxDEV(Heading, {\n                mb: 2,\n                as: \"h5\",\n                size: \"sm\",\n                children: \"Ticket Status\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 105,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Text, {\n                ml: 4,\n                size: \"xs\",\n                children: data.ticket.status\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 108,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 104,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(GridItem, {\n            children: /*#__PURE__*/_jsxDEV(Box, {\n              mb: 4,\n              children: [/*#__PURE__*/_jsxDEV(Heading, {\n                mb: 2,\n                as: \"h5\",\n                size: \"sm\",\n                children: \"Ticket Priority\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 115,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Text, {\n                ml: 4,\n                size: \"xs\",\n                children: data.ticket.priority\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 118,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 114,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(GridItem, {\n            children: /*#__PURE__*/_jsxDEV(Box, {\n              mb: 4,\n              children: [/*#__PURE__*/_jsxDEV(Heading, {\n                mb: 2,\n                as: \"h5\",\n                size: \"sm\",\n                children: \"Created At\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 125,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Text, {\n                ml: 4,\n                size: \"xs\",\n                children: data.ticket.createdAt\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 128,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 124,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(GridItem, {\n            children: [/*#__PURE__*/_jsxDEV(Heading, {\n              mb: 2,\n              as: \"h5\",\n              size: \"sm\",\n              children: \"Last Updated\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 134,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Text, {\n              ml: 4,\n              size: \"xs\",\n              children: data.ticket.updatedAt\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 137,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Box, {\n        mr: 4,\n        ml: 6,\n        mb: 4,\n        children: [/*#__PURE__*/_jsxDEV(List, {\n          children: data === null || data === void 0 ? void 0 : (_data$ticket = data.ticket) === null || _data$ticket === void 0 ? void 0 : (_data$ticket$comments = _data$ticket.comments) === null || _data$ticket$comments === void 0 ? void 0 : _data$ticket$comments.map(comment => {\n            return /*#__PURE__*/_jsxDEV(Flex, {\n              mb: 4,\n              alignItems: \"center\",\n              justifyContent: \"space-between\",\n              children: [/*#__PURE__*/_jsxDEV(ListItem, {\n                p: 2,\n                bg: \"gray.100\",\n                borderRadius: 8,\n                children: /*#__PURE__*/_jsxDEV(Text, {\n                  wordBreak: \"break-all\",\n                  width: \"100%\",\n                  children: comment.text\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 149,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 148,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(ListItem, {\n                ml: 2,\n                children: /*#__PURE__*/_jsxDEV(Heading, {\n                  as: \"h6\",\n                  size: \"sm\",\n                  children: comment.user.username\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 154,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 153,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 147,\n              columnNumber: 17\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Formik, {\n          initialValues: {\n            text: \"\"\n          },\n          onSubmit: async values => {\n            const {\n              errors\n            } = await createComment({\n              variables: {\n                options: _objectSpread({}, values),\n                ticketId: data.ticket.id\n              } // refetchQueries: [{ query: TicketDocument }],\n\n            }); // todo improve error handling\n\n            if (errors) {\n              console.log(errors);\n            }\n          },\n          children: ({\n            isSubmitting\n          }) => /*#__PURE__*/_jsxDEV(Box, {\n            children: /*#__PURE__*/_jsxDEV(Form, {\n              children: [/*#__PURE__*/_jsxDEV(InputField, {\n                name: \"text\",\n                label: \"text\",\n                placeholder: \"Comment\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 183,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                mt: 4,\n                type: \"submit\",\n                isLoading: isSubmitting,\n                bg: \"teal\",\n                children: \"Create Comment\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 184,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 182,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 55,\n    columnNumber: 5\n  }, this);\n};\n\nexport default withApollo({\n  ssr: true\n})(Ticket);","map":{"version":3,"sources":["/Users/nicholasharvey/Desktop/programming/techChased/web/src/pages/tickets/[id].tsx"],"names":["Box","Button","Flex","Grid","GridItem","Heading","IconButton","Link","List","ListItem","Stack","Text","React","Layout","useGetTicketFromUrl","withApollo","NextLink","useCreateCommentMutation","useDeleteTicketMutation","DeleteIcon","useRouter","Form","Formik","InputField","Ticket","data","error","loading","deleteTicket","createComment","router","console","log","ticket","comments","message","text","id","variables","update","cache","evict","back","title","description","status","priority","createdAt","updatedAt","map","comment","user","username","values","errors","options","ticketId","isSubmitting","ssr"],"mappings":"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","sourcesContent":["import {\n  Box,\n  Button,\n  Flex,\n  Grid,\n  GridItem,\n  Heading,\n  IconButton,\n  Link,\n  List,\n  ListItem,\n  Stack,\n  Text,\n} from \"@chakra-ui/react\";\nimport React from \"react\";\nimport { Layout } from \"../../components/Layout\";\nimport { useGetTicketFromUrl } from \"../../utils/useGetTicketFromUrl\";\nimport { withApollo } from \"../../utils/withApollo\";\nimport NextLink from \"next/link\";\nimport {\n  useCreateCommentMutation,\n  useDeleteTicketMutation,\n} from \"../../generated/graphql\";\nimport { DeleteIcon } from \"@chakra-ui/icons\";\nimport { useRouter } from \"next/router\";\nimport { Form, Formik } from \"formik\";\nimport { InputField } from \"../../components/inputField\";\n\nconst Ticket = ({}) => {\n  const { data, error, loading } = useGetTicketFromUrl();\n  const [deleteTicket] = useDeleteTicketMutation();\n  const [createComment] = useCreateCommentMutation();\n  const router = useRouter();\n\n  console.log(data?.ticket.comments);\n  if (loading) {\n    return (\n      <Layout>\n        <div>loading..</div>\n      </Layout>\n    );\n  }\n\n  if (error) {\n    return <div>{error.message}</div>;\n  }\n  if (!data?.ticket) {\n    return (\n      <Layout>\n        <Box> Could not find ticket.</Box>\n      </Layout>\n    );\n  }\n  return (\n    <Layout>\n      {data.ticket.comments[0].text}\n      <Stack ml={4} mb={10} mt={-2} bg=\"yellow.400\">\n        <Heading as=\"h3\" ml={4} size=\"lg\" mb={3} mt={3}>\n          Details for Ticket #{data.ticket.id}\n        </Heading>\n        <Flex alignItems=\"center\">\n          <NextLink href={`/tickets/edit/${data.ticket.id}`}>\n            <Link ml={4}>Edit |</Link>\n          </NextLink>\n          <IconButton\n            icon={<DeleteIcon />}\n            aria-label=\"Delete Ticket\"\n            onClick={() => {\n              deleteTicket({\n                variables: { id: data.ticket.id },\n                update: (cache) => {\n                  cache.evict({ id: \"Ticket:\" + data.ticket.id });\n                  router.back();\n                },\n              });\n            }}\n          />\n        </Flex>\n      </Stack>\n      <Grid gridTemplateColumns=\"repeat(2, 50%)\">\n        <Box ml={4}>\n          <Grid templateColumns=\"repeat(2,1fr)\" templateRows=\"auto\">\n            <GridItem>\n              <Box mb={4}>\n                <Heading mb={2} as=\"h5\" size=\"sm\">\n                  Ticket Title\n                </Heading>\n                <Text ml={4} size=\"xs\">\n                  {data.ticket.title}\n                </Text>\n              </Box>\n            </GridItem>\n            <GridItem>\n              <Box mb={4}>\n                <Heading mb={2} as=\"h5\" size=\"sm\">\n                  Ticket Description\n                </Heading>\n                <Text ml={4} size=\"xs\">\n                  {data.ticket.description}\n                </Text>\n              </Box>\n            </GridItem>\n            <GridItem>\n              <Box mb={4}>\n                <Heading mb={2} as=\"h5\" size=\"sm\">\n                  Ticket Status\n                </Heading>\n                <Text ml={4} size=\"xs\">\n                  {data.ticket.status}\n                </Text>\n              </Box>\n            </GridItem>\n            <GridItem>\n              <Box mb={4}>\n                <Heading mb={2} as=\"h5\" size=\"sm\">\n                  Ticket Priority\n                </Heading>\n                <Text ml={4} size=\"xs\">\n                  {data.ticket.priority}\n                </Text>\n              </Box>\n            </GridItem>\n            <GridItem>\n              <Box mb={4}>\n                <Heading mb={2} as=\"h5\" size=\"sm\">\n                  Created At\n                </Heading>\n                <Text ml={4} size=\"xs\">\n                  {data.ticket.createdAt}\n                </Text>\n              </Box>\n            </GridItem>\n            <GridItem>\n              <Heading mb={2} as=\"h5\" size=\"sm\">\n                Last Updated\n              </Heading>\n              <Text ml={4} size=\"xs\">\n                {data.ticket.updatedAt}\n              </Text>\n            </GridItem>\n          </Grid>\n        </Box>\n        <Box mr={4} ml={6} mb={4}>\n          <List>\n            {data?.ticket?.comments?.map((comment) => {\n              return (\n                <Flex mb={4} alignItems=\"center\" justifyContent=\"space-between\">\n                  <ListItem p={2} bg=\"gray.100\" borderRadius={8}>\n                    <Text wordBreak=\"break-all\" width=\"100%\">\n                      {comment.text}\n                    </Text>\n                  </ListItem>\n                  <ListItem ml={2}>\n                    <Heading as=\"h6\" size=\"sm\">\n                      {comment.user.username}\n                    </Heading>\n                  </ListItem>\n                </Flex>\n              );\n            })}\n          </List>\n\n          <Formik\n            initialValues={{ text: \"\" }}\n            onSubmit={async (values) => {\n              const { errors } = await createComment({\n                variables: {\n                  options: { ...values },\n                  ticketId: data.ticket.id,\n                },\n\n                // refetchQueries: [{ query: TicketDocument }],\n              });\n              // todo improve error handling\n              if (errors) {\n                console.log(errors);\n              }\n            }}\n          >\n            {({ isSubmitting }) => (\n              <Box>\n                <Form>\n                  <InputField name=\"text\" label=\"text\" placeholder=\"Comment\" />\n                  <Button\n                    mt={4}\n                    type=\"submit\"\n                    isLoading={isSubmitting}\n                    bg=\"teal\"\n                  >\n                    Create Comment\n                  </Button>\n                </Form>\n              </Box>\n            )}\n          </Formik>\n        </Box>\n      </Grid>\n    </Layout>\n  );\n};\n\nexport default withApollo({ ssr: true })(Ticket);\n"]},"metadata":{},"sourceType":"module"}