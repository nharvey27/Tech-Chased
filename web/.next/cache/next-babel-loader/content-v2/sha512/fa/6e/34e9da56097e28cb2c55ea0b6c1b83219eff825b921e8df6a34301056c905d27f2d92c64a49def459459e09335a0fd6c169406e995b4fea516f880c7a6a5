{"ast":null,"code":"import _regeneratorRuntime from \"/Users/nicholasharvey/Desktop/programming/techChased/web/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _defineProperty from \"/Users/nicholasharvey/Desktop/programming/techChased/web/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"/Users/nicholasharvey/Desktop/programming/techChased/web/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _slicedToArray from \"/Users/nicholasharvey/Desktop/programming/techChased/web/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectDestructuringEmpty from \"/Users/nicholasharvey/Desktop/programming/techChased/web/node_modules/next/node_modules/@babel/runtime/helpers/esm/objectDestructuringEmpty\";\n\nvar _jsxFileName = \"/Users/nicholasharvey/Desktop/programming/techChased/web/src/pages/tickets/[id].tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { Box, Button, Flex, Grid, GridItem, Heading, IconButton, Link, Stack, Text } from \"@chakra-ui/react\";\nimport React from \"react\";\nimport { Layout } from \"../../components/Layout\";\nimport { useGetTicketFromUrl } from \"../../utils/useGetTicketFromUrl\";\nimport { withApollo } from \"../../utils/withApollo\";\nimport NextLink from \"next/link\";\nimport { TicketDocument, useCreateCommentMutation, useDeleteTicketMutation } from \"../../generated/graphql\";\nimport { DeleteIcon } from \"@chakra-ui/icons\";\nimport { useRouter } from \"next/router\";\nimport { Form, Formik } from \"formik\";\nimport { InputField } from \"../../components/inputField\";\n\nvar Ticket = function Ticket(_ref) {\n  _s();\n\n  var _data$ticket$comments;\n\n  _objectDestructuringEmpty(_ref);\n\n  var _useGetTicketFromUrl = useGetTicketFromUrl(),\n      data = _useGetTicketFromUrl.data,\n      error = _useGetTicketFromUrl.error,\n      loading = _useGetTicketFromUrl.loading;\n\n  var _useDeleteTicketMutat = useDeleteTicketMutation(),\n      _useDeleteTicketMutat2 = _slicedToArray(_useDeleteTicketMutat, 1),\n      deleteTicket = _useDeleteTicketMutat2[0];\n\n  var _useCreateCommentMuta = useCreateCommentMutation(),\n      _useCreateCommentMuta2 = _slicedToArray(_useCreateCommentMuta, 1),\n      createComment = _useCreateCommentMuta2[0];\n\n  var router = useRouter();\n\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(Layout, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"loading..\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 37,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 36,\n      columnNumber: 7\n    }, _this);\n  }\n\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: error.message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 12\n    }, _this);\n  }\n\n  if (!(data !== null && data !== void 0 && data.ticket)) {\n    return /*#__PURE__*/_jsxDEV(Layout, {\n      children: /*#__PURE__*/_jsxDEV(Box, {\n        children: \" Could not find ticket.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 7\n    }, _this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(Layout, {\n    children: [/*#__PURE__*/_jsxDEV(Stack, {\n      ml: 4,\n      mb: 10,\n      mt: -2,\n      bg: \"yellow.400\",\n      children: [/*#__PURE__*/_jsxDEV(Heading, {\n        as: \"h3\",\n        ml: 4,\n        size: \"lg\",\n        mb: 3,\n        mt: 3,\n        children: [\"Details for Ticket #\", data.ticket.id]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(Flex, {\n        alignItems: \"center\",\n        children: [/*#__PURE__*/_jsxDEV(NextLink, {\n          href: \"/tickets/edit/\".concat(data.ticket.id),\n          children: /*#__PURE__*/_jsxDEV(Link, {\n            ml: 4,\n            children: \"Edit |\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 60,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(IconButton, {\n          icon: /*#__PURE__*/_jsxDEV(DeleteIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 63,\n            columnNumber: 19\n          }, _this),\n          \"aria-label\": \"Delete Ticket\",\n          onClick: function onClick() {\n            deleteTicket({\n              variables: {\n                id: data.ticket.id\n              },\n              update: function update(cache) {\n                cache.evict({\n                  id: \"Ticket:\" + data.ticket.id\n                });\n                router.back();\n              }\n            });\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(Grid, {\n      gridTemplateColumns: \"repeat(2, 50%)\",\n      children: [/*#__PURE__*/_jsxDEV(Box, {\n        ml: 4,\n        children: /*#__PURE__*/_jsxDEV(Grid, {\n          templateColumns: \"repeat(2,1fr)\",\n          templateRows: \"auto\",\n          children: [/*#__PURE__*/_jsxDEV(GridItem, {\n            children: /*#__PURE__*/_jsxDEV(Box, {\n              mb: 4,\n              children: [/*#__PURE__*/_jsxDEV(Heading, {\n                mb: 2,\n                as: \"h5\",\n                size: \"sm\",\n                children: \"Ticket Title\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 82,\n                columnNumber: 17\n              }, _this), /*#__PURE__*/_jsxDEV(Text, {\n                ml: 4,\n                size: \"xs\",\n                children: data.ticket.title\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 85,\n                columnNumber: 17\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 81,\n              columnNumber: 15\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(GridItem, {\n            children: /*#__PURE__*/_jsxDEV(Box, {\n              mb: 4,\n              children: [/*#__PURE__*/_jsxDEV(Heading, {\n                mb: 2,\n                as: \"h5\",\n                size: \"sm\",\n                children: \"Ticket Description\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 92,\n                columnNumber: 17\n              }, _this), /*#__PURE__*/_jsxDEV(Text, {\n                ml: 4,\n                size: \"xs\",\n                children: data.ticket.description\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 95,\n                columnNumber: 17\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 91,\n              columnNumber: 15\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(GridItem, {\n            children: /*#__PURE__*/_jsxDEV(Box, {\n              mb: 4,\n              children: [/*#__PURE__*/_jsxDEV(Heading, {\n                mb: 2,\n                as: \"h5\",\n                size: \"sm\",\n                children: \"Ticket Status\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 102,\n                columnNumber: 17\n              }, _this), /*#__PURE__*/_jsxDEV(Text, {\n                ml: 4,\n                size: \"xs\",\n                children: data.ticket.status\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 105,\n                columnNumber: 17\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 101,\n              columnNumber: 15\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(GridItem, {\n            children: /*#__PURE__*/_jsxDEV(Box, {\n              mb: 4,\n              children: [/*#__PURE__*/_jsxDEV(Heading, {\n                mb: 2,\n                as: \"h5\",\n                size: \"sm\",\n                children: \"Ticket Priority\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 112,\n                columnNumber: 17\n              }, _this), /*#__PURE__*/_jsxDEV(Text, {\n                ml: 4,\n                size: \"xs\",\n                children: data.ticket.priority\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 115,\n                columnNumber: 17\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 111,\n              columnNumber: 15\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 110,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(GridItem, {\n            children: /*#__PURE__*/_jsxDEV(Box, {\n              mb: 4,\n              children: [/*#__PURE__*/_jsxDEV(Heading, {\n                mb: 2,\n                as: \"h5\",\n                size: \"sm\",\n                children: \"Created At\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 122,\n                columnNumber: 17\n              }, _this), /*#__PURE__*/_jsxDEV(Text, {\n                ml: 4,\n                size: \"xs\",\n                children: data.ticket.createdAt\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 125,\n                columnNumber: 17\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 121,\n              columnNumber: 15\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(GridItem, {\n            children: [/*#__PURE__*/_jsxDEV(Heading, {\n              mb: 2,\n              as: \"h5\",\n              size: \"sm\",\n              children: \"Last Updated\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 131,\n              columnNumber: 15\n            }, _this), /*#__PURE__*/_jsxDEV(Text, {\n              ml: 4,\n              size: \"xs\",\n              children: data.ticket.updatedAt\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 134,\n              columnNumber: 15\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 13\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 11\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(Box, {\n        mr: 4,\n        children: /*#__PURE__*/_jsxDEV(Stack, {\n          children: [(_data$ticket$comments = data.ticket.comments) === null || _data$ticket$comments === void 0 ? void 0 : _data$ticket$comments.map(function (comment) {\n            !comment ? null : /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(Text, {\n                children: comment.text\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 145,\n                columnNumber: 19\n              }, _this), \";\", /*#__PURE__*/_jsxDEV(Heading, {\n                children: comment.user.username\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 146,\n                columnNumber: 19\n              }, _this), \";\"]\n            }, void 0, true);\n          }), /*#__PURE__*/_jsxDEV(Formik, {\n            initialValues: {\n              text: \"\"\n            },\n            onSubmit: /*#__PURE__*/function () {\n              var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(values) {\n                var _yield$createComment, errors;\n\n                return _regeneratorRuntime.wrap(function _callee$(_context) {\n                  while (1) {\n                    switch (_context.prev = _context.next) {\n                      case 0:\n                        _context.next = 2;\n                        return createComment({\n                          variables: {\n                            options: _objectSpread({}, values),\n                            ticketId: data.ticket.id\n                          },\n                          refetchQueries: [{\n                            query: TicketDocument\n                          }]\n                        });\n\n                      case 2:\n                        _yield$createComment = _context.sent;\n                        errors = _yield$createComment.errors;\n\n                        // todo improve error handling\n                        if (errors) {\n                          console.log(errors);\n                        }\n\n                      case 5:\n                      case \"end\":\n                        return _context.stop();\n                    }\n                  }\n                }, _callee);\n              }));\n\n              return function (_x) {\n                return _ref2.apply(this, arguments);\n              };\n            }(),\n            children: function children(_ref3) {\n              var isSubmitting = _ref3.isSubmitting;\n              return /*#__PURE__*/_jsxDEV(Box, {\n                children: /*#__PURE__*/_jsxDEV(Form, {\n                  children: [/*#__PURE__*/_jsxDEV(InputField, {\n                    name: \"text\",\n                    label: \"text\",\n                    placeholder: \"Comment\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 170,\n                    columnNumber: 21\n                  }, _this), /*#__PURE__*/_jsxDEV(Button, {\n                    type: \"submit\",\n                    isLoading: isSubmitting,\n                    bg: \"teal\",\n                    children: \"Create Comment\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 175,\n                    columnNumber: 21\n                  }, _this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 169,\n                  columnNumber: 19\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 168,\n                columnNumber: 17\n              }, _this);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 150,\n            columnNumber: 13\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 11\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 53,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(Ticket, \"+DMgyJFU8ZMJwyc1AnNitX4ZPg4=\", false, function () {\n  return [useGetTicketFromUrl, useDeleteTicketMutation, useCreateCommentMutation, useRouter];\n});\n\n_c = Ticket;\nexport default withApollo({\n  ssr: true\n})(Ticket);\n\nvar _c;\n\n$RefreshReg$(_c, \"Ticket\");","map":{"version":3,"sources":["/Users/nicholasharvey/Desktop/programming/techChased/web/src/pages/tickets/[id].tsx"],"names":["Box","Button","Flex","Grid","GridItem","Heading","IconButton","Link","Stack","Text","React","Layout","useGetTicketFromUrl","withApollo","NextLink","TicketDocument","useCreateCommentMutation","useDeleteTicketMutation","DeleteIcon","useRouter","Form","Formik","InputField","Ticket","data","error","loading","deleteTicket","createComment","router","message","ticket","id","variables","update","cache","evict","back","title","description","status","priority","createdAt","updatedAt","comments","map","comment","text","user","username","values","options","ticketId","refetchQueries","query","errors","console","log","isSubmitting","ssr"],"mappings":";;;;;;;;;;;;;;;;AAAA,SACEA,GADF,EAEEC,MAFF,EAGEC,IAHF,EAIEC,IAJF,EAKEC,QALF,EAMEC,OANF,EAOEC,UAPF,EAQEC,IARF,EASEC,KATF,EAUEC,IAVF,QAWO,kBAXP;AAYA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,MAAT,QAAuB,yBAAvB;AACA,SAASC,mBAAT,QAAoC,iCAApC;AACA,SAASC,UAAT,QAA2B,wBAA3B;AACA,OAAOC,QAAP,MAAqB,WAArB;AACA,SACEC,cADF,EAEEC,wBAFF,EAGEC,uBAHF,QAIO,yBAJP;AAKA,SAASC,UAAT,QAA2B,kBAA3B;AACA,SAASC,SAAT,QAA0B,aAA1B;AACA,SAASC,IAAT,EAAeC,MAAf,QAA6B,QAA7B;AACA,SAASC,UAAT,QAA2B,6BAA3B;;AAEA,IAAMC,MAAM,GAAG,SAATA,MAAS,OAAQ;AAAA;;AAAA;;AAAA;;AAAA,6BACYX,mBAAmB,EAD/B;AAAA,MACbY,IADa,wBACbA,IADa;AAAA,MACPC,KADO,wBACPA,KADO;AAAA,MACAC,OADA,wBACAA,OADA;;AAAA,8BAEET,uBAAuB,EAFzB;AAAA;AAAA,MAEdU,YAFc;;AAAA,8BAGGX,wBAAwB,EAH3B;AAAA;AAAA,MAGdY,aAHc;;AAIrB,MAAMC,MAAM,GAAGV,SAAS,EAAxB;;AAEA,MAAIO,OAAJ,EAAa;AACX,wBACE,QAAC,MAAD;AAAA,6BACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,aADF;AAKD;;AAED,MAAID,KAAJ,EAAW;AACT,wBAAO;AAAA,gBAAMA,KAAK,CAACK;AAAZ;AAAA;AAAA;AAAA;AAAA,aAAP;AACD;;AACD,MAAI,EAACN,IAAD,aAACA,IAAD,eAACA,IAAI,CAAEO,MAAP,CAAJ,EAAmB;AACjB,wBACE,QAAC,MAAD;AAAA,6BACE,QAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,aADF;AAKD;;AACD,sBACE,QAAC,MAAD;AAAA,4BACE,QAAC,KAAD;AAAO,MAAA,EAAE,EAAE,CAAX;AAAc,MAAA,EAAE,EAAE,EAAlB;AAAsB,MAAA,EAAE,EAAE,CAAC,CAA3B;AAA8B,MAAA,EAAE,EAAC,YAAjC;AAAA,8BACE,QAAC,OAAD;AAAS,QAAA,EAAE,EAAC,IAAZ;AAAiB,QAAA,EAAE,EAAE,CAArB;AAAwB,QAAA,IAAI,EAAC,IAA7B;AAAkC,QAAA,EAAE,EAAE,CAAtC;AAAyC,QAAA,EAAE,EAAE,CAA7C;AAAA,2CACuBP,IAAI,CAACO,MAAL,CAAYC,EADnC;AAAA;AAAA;AAAA;AAAA;AAAA,eADF,eAIE,QAAC,IAAD;AAAM,QAAA,UAAU,EAAC,QAAjB;AAAA,gCACE,QAAC,QAAD;AAAU,UAAA,IAAI,0BAAmBR,IAAI,CAACO,MAAL,CAAYC,EAA/B,CAAd;AAAA,iCACE,QAAC,IAAD;AAAM,YAAA,EAAE,EAAE,CAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,iBADF,eAIE,QAAC,UAAD;AACE,UAAA,IAAI,eAAE,QAAC,UAAD;AAAA;AAAA;AAAA;AAAA,mBADR;AAEE,wBAAW,eAFb;AAGE,UAAA,OAAO,EAAE,mBAAM;AACbL,YAAAA,YAAY,CAAC;AACXM,cAAAA,SAAS,EAAE;AAAED,gBAAAA,EAAE,EAAER,IAAI,CAACO,MAAL,CAAYC;AAAlB,eADA;AAEXE,cAAAA,MAAM,EAAE,gBAACC,KAAD,EAAW;AACjBA,gBAAAA,KAAK,CAACC,KAAN,CAAY;AAAEJ,kBAAAA,EAAE,EAAE,YAAYR,IAAI,CAACO,MAAL,CAAYC;AAA9B,iBAAZ;AACAH,gBAAAA,MAAM,CAACQ,IAAP;AACD;AALU,aAAD,CAAZ;AAOD;AAXH;AAAA;AAAA;AAAA;AAAA,iBAJF;AAAA;AAAA;AAAA;AAAA;AAAA,eAJF;AAAA;AAAA;AAAA;AAAA;AAAA,aADF,eAwBE,QAAC,IAAD;AAAM,MAAA,mBAAmB,EAAC,gBAA1B;AAAA,8BACE,QAAC,GAAD;AAAK,QAAA,EAAE,EAAE,CAAT;AAAA,+BACE,QAAC,IAAD;AAAM,UAAA,eAAe,EAAC,eAAtB;AAAsC,UAAA,YAAY,EAAC,MAAnD;AAAA,kCACE,QAAC,QAAD;AAAA,mCACE,QAAC,GAAD;AAAK,cAAA,EAAE,EAAE,CAAT;AAAA,sCACE,QAAC,OAAD;AAAS,gBAAA,EAAE,EAAE,CAAb;AAAgB,gBAAA,EAAE,EAAC,IAAnB;AAAwB,gBAAA,IAAI,EAAC,IAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBADF,eAIE,QAAC,IAAD;AAAM,gBAAA,EAAE,EAAE,CAAV;AAAa,gBAAA,IAAI,EAAC,IAAlB;AAAA,0BACGb,IAAI,CAACO,MAAL,CAAYO;AADf;AAAA;AAAA;AAAA;AAAA,uBAJF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,mBADF,eAWE,QAAC,QAAD;AAAA,mCACE,QAAC,GAAD;AAAK,cAAA,EAAE,EAAE,CAAT;AAAA,sCACE,QAAC,OAAD;AAAS,gBAAA,EAAE,EAAE,CAAb;AAAgB,gBAAA,EAAE,EAAC,IAAnB;AAAwB,gBAAA,IAAI,EAAC,IAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBADF,eAIE,QAAC,IAAD;AAAM,gBAAA,EAAE,EAAE,CAAV;AAAa,gBAAA,IAAI,EAAC,IAAlB;AAAA,0BACGd,IAAI,CAACO,MAAL,CAAYQ;AADf;AAAA;AAAA;AAAA;AAAA,uBAJF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,mBAXF,eAqBE,QAAC,QAAD;AAAA,mCACE,QAAC,GAAD;AAAK,cAAA,EAAE,EAAE,CAAT;AAAA,sCACE,QAAC,OAAD;AAAS,gBAAA,EAAE,EAAE,CAAb;AAAgB,gBAAA,EAAE,EAAC,IAAnB;AAAwB,gBAAA,IAAI,EAAC,IAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBADF,eAIE,QAAC,IAAD;AAAM,gBAAA,EAAE,EAAE,CAAV;AAAa,gBAAA,IAAI,EAAC,IAAlB;AAAA,0BACGf,IAAI,CAACO,MAAL,CAAYS;AADf;AAAA;AAAA;AAAA;AAAA,uBAJF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,mBArBF,eA+BE,QAAC,QAAD;AAAA,mCACE,QAAC,GAAD;AAAK,cAAA,EAAE,EAAE,CAAT;AAAA,sCACE,QAAC,OAAD;AAAS,gBAAA,EAAE,EAAE,CAAb;AAAgB,gBAAA,EAAE,EAAC,IAAnB;AAAwB,gBAAA,IAAI,EAAC,IAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBADF,eAIE,QAAC,IAAD;AAAM,gBAAA,EAAE,EAAE,CAAV;AAAa,gBAAA,IAAI,EAAC,IAAlB;AAAA,0BACGhB,IAAI,CAACO,MAAL,CAAYU;AADf;AAAA;AAAA;AAAA;AAAA,uBAJF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,mBA/BF,eAyCE,QAAC,QAAD;AAAA,mCACE,QAAC,GAAD;AAAK,cAAA,EAAE,EAAE,CAAT;AAAA,sCACE,QAAC,OAAD;AAAS,gBAAA,EAAE,EAAE,CAAb;AAAgB,gBAAA,EAAE,EAAC,IAAnB;AAAwB,gBAAA,IAAI,EAAC,IAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBADF,eAIE,QAAC,IAAD;AAAM,gBAAA,EAAE,EAAE,CAAV;AAAa,gBAAA,IAAI,EAAC,IAAlB;AAAA,0BACGjB,IAAI,CAACO,MAAL,CAAYW;AADf;AAAA;AAAA;AAAA;AAAA,uBAJF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,mBAzCF,eAmDE,QAAC,QAAD;AAAA,oCACE,QAAC,OAAD;AAAS,cAAA,EAAE,EAAE,CAAb;AAAgB,cAAA,EAAE,EAAC,IAAnB;AAAwB,cAAA,IAAI,EAAC,IAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBADF,eAIE,QAAC,IAAD;AAAM,cAAA,EAAE,EAAE,CAAV;AAAa,cAAA,IAAI,EAAC,IAAlB;AAAA,wBACGlB,IAAI,CAACO,MAAL,CAAYY;AADf;AAAA;AAAA;AAAA;AAAA,qBAJF;AAAA;AAAA;AAAA;AAAA;AAAA,mBAnDF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,eADF,eA+DE,QAAC,GAAD;AAAK,QAAA,EAAE,EAAE,CAAT;AAAA,+BACE,QAAC,KAAD;AAAA,8CACGnB,IAAI,CAACO,MAAL,CAAYa,QADf,0DACG,sBAAsBC,GAAtB,CAA0B,UAACC,OAAD,EAAa;AACtC,aAACA,OAAD,GAAW,IAAX,gBACE;AAAA,sCACE,QAAC,IAAD;AAAA,0BAAOA,OAAO,CAACC;AAAf;AAAA;AAAA;AAAA;AAAA,uBADF,oBAEE,QAAC,OAAD;AAAA,0BAAUD,OAAO,CAACE,IAAR,CAAaC;AAAvB;AAAA;AAAA;AAAA;AAAA,uBAFF;AAAA,4BADF;AAMD,WAPA,CADH,eASE,QAAC,MAAD;AACE,YAAA,aAAa,EAAE;AAAEF,cAAAA,IAAI,EAAE;AAAR,aADjB;AAEE,YAAA,QAAQ;AAAA,mFAAE,iBAAOG,MAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BACiBtB,aAAa,CAAC;AACrCK,0BAAAA,SAAS,EAAE;AACTkB,4BAAAA,OAAO,oBAAOD,MAAP,CADE;AAETE,4BAAAA,QAAQ,EAAE5B,IAAI,CAACO,MAAL,CAAYC;AAFb,2BAD0B;AAMrCqB,0BAAAA,cAAc,EAAE,CAAC;AAAEC,4BAAAA,KAAK,EAAEvC;AAAT,2BAAD;AANqB,yBAAD,CAD9B;;AAAA;AAAA;AACAwC,wBAAAA,MADA,wBACAA,MADA;;AASR;AACA,4BAAIA,MAAJ,EAAY;AACVC,0BAAAA,OAAO,CAACC,GAAR,CAAYF,MAAZ;AACD;;AAZO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAAF;;AAAA;AAAA;AAAA;AAAA,eAFV;AAAA,sBAiBG;AAAA,kBAAGG,YAAH,SAAGA,YAAH;AAAA,kCACC,QAAC,GAAD;AAAA,uCACE,QAAC,IAAD;AAAA,0CACE,QAAC,UAAD;AACE,oBAAA,IAAI,EAAC,MADP;AAEE,oBAAA,KAAK,EAAC,MAFR;AAGE,oBAAA,WAAW,EAAC;AAHd;AAAA;AAAA;AAAA;AAAA,2BADF,eAME,QAAC,MAAD;AAAQ,oBAAA,IAAI,EAAC,QAAb;AAAsB,oBAAA,SAAS,EAAEA,YAAjC;AAA+C,oBAAA,EAAE,EAAC,MAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BANF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,uBADD;AAAA;AAjBH;AAAA;AAAA;AAAA;AAAA,mBATF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,eA/DF;AAAA;AAAA;AAAA;AAAA;AAAA,aAxBF;AAAA;AAAA;AAAA;AAAA;AAAA,WADF;AAuID,CA/JD;;GAAMnC,M;UAC6BX,mB,EACVK,uB,EACCD,wB,EACTG,S;;;KAJXI,M;AAiKN,eAAeV,UAAU,CAAC;AAAE8C,EAAAA,GAAG,EAAE;AAAP,CAAD,CAAV,CAA0BpC,MAA1B,CAAf","sourcesContent":["import {\n  Box,\n  Button,\n  Flex,\n  Grid,\n  GridItem,\n  Heading,\n  IconButton,\n  Link,\n  Stack,\n  Text,\n} from \"@chakra-ui/react\";\nimport React from \"react\";\nimport { Layout } from \"../../components/Layout\";\nimport { useGetTicketFromUrl } from \"../../utils/useGetTicketFromUrl\";\nimport { withApollo } from \"../../utils/withApollo\";\nimport NextLink from \"next/link\";\nimport {\n  TicketDocument,\n  useCreateCommentMutation,\n  useDeleteTicketMutation,\n} from \"../../generated/graphql\";\nimport { DeleteIcon } from \"@chakra-ui/icons\";\nimport { useRouter } from \"next/router\";\nimport { Form, Formik } from \"formik\";\nimport { InputField } from \"../../components/inputField\";\n\nconst Ticket = ({}) => {\n  const { data, error, loading } = useGetTicketFromUrl();\n  const [deleteTicket] = useDeleteTicketMutation();\n  const [createComment] = useCreateCommentMutation();\n  const router = useRouter();\n\n  if (loading) {\n    return (\n      <Layout>\n        <div>loading..</div>\n      </Layout>\n    );\n  }\n\n  if (error) {\n    return <div>{error.message}</div>;\n  }\n  if (!data?.ticket) {\n    return (\n      <Layout>\n        <Box> Could not find ticket.</Box>\n      </Layout>\n    );\n  }\n  return (\n    <Layout>\n      <Stack ml={4} mb={10} mt={-2} bg=\"yellow.400\">\n        <Heading as=\"h3\" ml={4} size=\"lg\" mb={3} mt={3}>\n          Details for Ticket #{data.ticket.id}\n        </Heading>\n        <Flex alignItems=\"center\">\n          <NextLink href={`/tickets/edit/${data.ticket.id}`}>\n            <Link ml={4}>Edit |</Link>\n          </NextLink>\n          <IconButton\n            icon={<DeleteIcon />}\n            aria-label=\"Delete Ticket\"\n            onClick={() => {\n              deleteTicket({\n                variables: { id: data.ticket.id },\n                update: (cache) => {\n                  cache.evict({ id: \"Ticket:\" + data.ticket.id });\n                  router.back();\n                },\n              });\n            }}\n          />\n        </Flex>\n      </Stack>\n      <Grid gridTemplateColumns=\"repeat(2, 50%)\">\n        <Box ml={4}>\n          <Grid templateColumns=\"repeat(2,1fr)\" templateRows=\"auto\">\n            <GridItem>\n              <Box mb={4}>\n                <Heading mb={2} as=\"h5\" size=\"sm\">\n                  Ticket Title\n                </Heading>\n                <Text ml={4} size=\"xs\">\n                  {data.ticket.title}\n                </Text>\n              </Box>\n            </GridItem>\n            <GridItem>\n              <Box mb={4}>\n                <Heading mb={2} as=\"h5\" size=\"sm\">\n                  Ticket Description\n                </Heading>\n                <Text ml={4} size=\"xs\">\n                  {data.ticket.description}\n                </Text>\n              </Box>\n            </GridItem>\n            <GridItem>\n              <Box mb={4}>\n                <Heading mb={2} as=\"h5\" size=\"sm\">\n                  Ticket Status\n                </Heading>\n                <Text ml={4} size=\"xs\">\n                  {data.ticket.status}\n                </Text>\n              </Box>\n            </GridItem>\n            <GridItem>\n              <Box mb={4}>\n                <Heading mb={2} as=\"h5\" size=\"sm\">\n                  Ticket Priority\n                </Heading>\n                <Text ml={4} size=\"xs\">\n                  {data.ticket.priority}\n                </Text>\n              </Box>\n            </GridItem>\n            <GridItem>\n              <Box mb={4}>\n                <Heading mb={2} as=\"h5\" size=\"sm\">\n                  Created At\n                </Heading>\n                <Text ml={4} size=\"xs\">\n                  {data.ticket.createdAt}\n                </Text>\n              </Box>\n            </GridItem>\n            <GridItem>\n              <Heading mb={2} as=\"h5\" size=\"sm\">\n                Last Updated\n              </Heading>\n              <Text ml={4} size=\"xs\">\n                {data.ticket.updatedAt}\n              </Text>\n            </GridItem>\n          </Grid>\n        </Box>\n        <Box mr={4}>\n          <Stack>\n            {data.ticket.comments?.map((comment) => {\n              !comment ? null : (\n                <>\n                  <Text>{comment.text}</Text>;\n                  <Heading>{comment.user.username}</Heading>;\n                </>\n              );\n            })}\n            <Formik\n              initialValues={{ text: \"\" }}\n              onSubmit={async (values) => {\n                const { errors } = await createComment({\n                  variables: {\n                    options: { ...values },\n                    ticketId: data.ticket.id,\n                  },\n\n                  refetchQueries: [{ query: TicketDocument }],\n                });\n                // todo improve error handling\n                if (errors) {\n                  console.log(errors);\n                }\n              }}\n            >\n              {({ isSubmitting }) => (\n                <Box>\n                  <Form>\n                    <InputField\n                      name=\"text\"\n                      label=\"text\"\n                      placeholder=\"Comment\"\n                    />\n                    <Button type=\"submit\" isLoading={isSubmitting} bg=\"teal\">\n                      Create Comment\n                    </Button>\n                  </Form>\n                </Box>\n              )}\n            </Formik>\n          </Stack>\n        </Box>\n      </Grid>\n    </Layout>\n  );\n};\n\nexport default withApollo({ ssr: true })(Ticket);\n"]},"metadata":{},"sourceType":"module"}